<!DOCTYPE html>
<html lang="en">
  <%- include('./../partials/head') %>
  <body>
    <%- include('./../partials/navbar') %>
    <section>
      <div class="container-form">
        <div class="errores">
          <ul>
            
          </ul>

        </div>
        <form
          class="main-form"
          action="/products/edit/<%= Product.id %>?_method=PUT"
          method="POST"
          enctype="multipart/form-data"
        >
          <h4>Formulario de edición de <%= Product.name %></h4>
          <input
            class="controls <%= locals.errors && errors.name ? 'is-invalid' : null %>"
            type="text"
            name="name"
            id="name"
            placeholder="nombre del producto"
            value="<%= Product.name%>"
          />
          <% if (locals.errors && errors.name) { %>
            <div class="text-danger"><%= errors.name.msg %></div>

            <% } %>
            <br>
          <input
            class="controls <%= locals.errors && errors.price ? 'is-invalid' : null %>"
            type="number"
            name="price"
            id="price"
            placeholder="precio"
            value="<%= Product.price %>"
          />
          <% if (locals.errors && errors.price) { %>
            <div class="text-danger"><%= errors.price.msg %></div>

            <% } %>
            <br>
          </br>
            <input class="controls <%= locals.errors && errors.stock ? 'is-invalid' : null %>" type="number" name="stock" id="stock" placeholder="stock del producto" value="<%= Product.stock %>" />
            <% if (locals.errors && errors.stock) { %>
              <div class="text-danger"><%= errors.stock.msg %></div>
  
              <% } %>
              <br>
              <label>¿Producto on sale?</label>
          <select class="<%= locals.errors && errors.on_sale ? 'is-invalid' : null %>" name="on_sale">
            <option value="">Selecionar</option>
            <%  
              let options = ['0', '1'];
            %>
            <% for (const oneOption of options) { %>
              <option 
                value="<%= oneOption %>"
                <%= Product.on_sale %> 
              > <%= oneOption %> </option>
            <% } %>
          </select>
          <% if (locals.errors && errors.on_sale) { %>
            <div class="text-danger"><%= errors.on_sale.msg %></div>

            <% } %>
          <br>
            <select
            class="p-2 border rounded-md <%= locals.errors && errors.presentation ? 'border-red-700' : null %>"
            name="presentation"
            id="presentation"
          >
            <option value="">Elegí una presentación</option>
            <%  
              let presentations = ['1kg', 'un atado', 'una unidad', '500gr', '250gr'];
            %>
            <% for (const onePresentation of presentations) { %>
              <option 
                value="<%= onePresentation %>"
                <%= Product.presentation %> 
              > <%= onePresentation %> </option>
            <% } %>
            
          </select>
          <% if (locals.errors && errors.presentation) { %>
            <div class="text-danger"><%= errors.presentation.msg %></div>

            <% } %>
       
        
          <input
            class="controls <%= locals.errors && errors.description ? 'is-invalid' : null %> "
            type="text"
            name="description"
            id="description"
            placeholder="Descripción del producto"
            value="<%= Product.description %>"
          />
          <% if (locals.errors && errors.description) { %>
            <div class="text-danger"><%= errors.description.msg %></div>

            <% } %>
          <br />
          <label for="category_id">Categorias </label>
          <p>
              <select name="category_id" id="category_id" required>
                  <% allCategories.forEach(category => { %>
                  <option value="<%= category.id %>" <% if (Product.category_id == category.id) { %><%= 'selected' %><% }; %>><%= category.name %></option>
                  <% }); %>
              </select>
              <% if (locals.errors && errors.category_id) { %>
                <div class="text-danger"><%= errors.category_id.msg %></div>
    
                <% } %>
          </p>
          <br />
          <label>Foto de producto</label>
          <input class="<%= locals.errors && errors.image ? 'is-invalid' : null %>" type="file" name="image" id="image" />
          <% if (locals.errors && errors.image) { %>
            <span class="text-danger"><%= errors.image.msg %> <i class="fa-solid fa-circle-exclamation"></i></span>
            <% } %>
          <button class="bottons" type="submit">MODIFICAR</button>
          <a href="/products/delete/<%= Product.id %>" class="product-card__button">Eliminar Producto</a>
        </form>
      </div>
    </section>
    <%- include('./../partials/footer') %> <%- include('./../partials/scripts') %>
    <script type="module" src="/js/edit.js"></script>
  </body>
</html>
