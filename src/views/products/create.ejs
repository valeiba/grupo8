<!DOCTYPE html>
<html lang="en">
  <%- include('./../partials/head') %>
  <body>
    <%- include('./../partials/navbar') %>

    <section>
      <div class="container-form">
        <form class="main-form" action="products/create" method="POST" enctype="multipart/form-data">
          <h4>Formulario de creación de productos</h4>
          <input class="controls <%= locals.errors && errors.name ? 'is-invalid' : null %>" type="text" name="name" id="name" placeholder="Nombre" value="<%= locals.oldData ? oldData.name : null %>" />
          <% if (locals.errors && errors.name) { %>
            <div class="text-danger"><%= errors.name.msg %></div>
            <% } %>
          <input class="controls <%= locals.errors && errors.price ? 'is-invalid' : null %>" type="number" name="price" id="price" placeholder="Precio" value="<%= locals.oldData ? oldData.price : null %>" />
          <% if (locals.errors && errors.price) { %>
            <div class="text-danger"><%= errors.price.msg %></div>
            <% } %>
            <select
            class="p-2 border rounded-md <%= locals.errors && errors.presentation ? 'border-red-700' : null %>"
            name="presentation"
            id="presentation"
          >
            <option value="">Elegí presentación</option>
            
            <option value="1 unidad">
              <%= locals.oldData && (product.presentation === oldData.product.presentation) ? 'selected' : null %> 
              1 unidad</option>
          </select>
            <% if (locals.errors && errors.presentation) { %>
              <div class="text-danger"><%= errors.presentation.msg %></div>
  
              <% } %>
        <input class="controls <%= locals.errors && errors.available ? 'is-invalid' : null %>" type="text" name="available" id="available"  value="<%= locals.oldData ? oldData.available : null %>" />
              <% if (locals.errors && errors.available) { %>
                <div class="text-danger"><%= errors.available.msg %></div>
    
                <% } %>
          <input
            class="controls <%= locals.errors && errors.description ? 'is-invalid' : null %>"
            type="text"
            name="description"
            id="description"
            placeholder="Descripción del producto"
            value="<%= locals.oldData ? oldData.description : null %>"
          />
          <% if (locals.errors && errors.description) { %>
            <div class="text-danger"><%= errors.description.msg %></div>

            <% } %>
          <br />
          <label>Selecionar categoria</label>
          <select class="<%= locals.errors && errors.category ? 'is-invalid' : null %>" name="category">
            <option value="">Categorías</option>
            <% for (const category of categories) { %>
              <option 
                value="<%= category.name %>"
                <%= locals.oldData && (category.name === oldData.category) ? 'selected' : null %> 
              > 
              <!-- Esto capitaliza las categorías -->
              <%= category.name[0].toUpperCase() + category.name.slice(1) %> </option>
            <% } %>
          </select>
          <br />
          <label>Foto de producto</label>
          <input class="<%= locals.errors && errors.image ? 'is-invalid' : null %>" type="file" name="image" />
          <% if (locals.errors && errors.image) { %>
            <span class="text-danger"><%= errors.image.msg %> <i class="fa-solid fa-circle-exclamation"></i></span>
            <% } %>
          <input class="bottons" type="submit" value="AGREGAR" />
        </form>
      </div>
    </section>
    <%- include('./../partials/footer') %> <%- include('./../partials/scripts') %>
  </body>
</html>
